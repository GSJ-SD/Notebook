#多重填补

数据缺失的机制由Rubin提出：
- 完全随机缺失（MCAR）：指缺失值不依赖于其他任何原因；
- 随机缺失（MAR）：指变量的缺失与其他变量可能相关但与该变量本身的数值无关；
- 非随机缺失（MNAR）：指缺失数据依赖于未观测到的数据。

缺失数据处理方法大致可分为基于完整数据、基于填补、基于极大似然和基于非随机缺失（MNAR）的缺失机制。其中，基于填补方法可分为单值填补和多重填补(MI)。常见的单值填补法包括均值、中位数、众数填补、末次观测值结转（LOCF）、基线观测值结转（BOCF）及最差观测值结转（WOCF）。
### 1 基本原理

多重填补旨在基于一个或多个模型填补缺失数据，并正确反映与“填补”过程相关的不确定性。该方法不是为每个缺失观测填补单个值，而是根据缺失观测的预测分布生成一组填补值，从而生成不同的填补数据集；然后再对每个填补数据集进行分析，并通过Rubin法则合并分析结果。多重填补主要包括以下三个步骤：

1. 选择可能有助于填补缺失数据的自变量，对缺失数据进行多次填补，创建多个不同的填补数据集，其中自变量应包括后续分析模型中的所有变量，以及能使MAR假设合理的辅助变量；
2. 采用既定的统计分析方法分别对每个填补数据集进行结果的关联估计，因此可计算估计系数和相应的标准误，作为每个填补数据集的关联度量；
3. 通过Rubin法则和相应的标准误合并每个填补数据集的关联估计，得到最终的分析结果。

### 2 多重填补方法类型及其比较

根据需填补变量的数量、资料类型不同，进行多重填补填补的方法不同。

- 对于单变量填补，若缺失变量为连续型，可采用线性回归模型（linear regression model）和预测均数匹配（predictive mean matching, PMM）；
- 如缺失变量为分类变量，可采用logistic回归模型（logistic regression model）；
- 对于多变量填补，即有多个变量含有缺失值，可采用基于链式方程的多重填补（MI by chained equations, MICE），又称为完全条件规范（fully conditional specification, FCS），或采用多变量正态填补（multivariate normal imputation, MVNI）。

有研究认为不同的多重填补方法,主要取决于缺失变量的类型（连续型或分类型）、包括在预测模型中的协变量的类型以及缺失模式的类型（单调性或非单调性）。也有研究根据填补方法的复杂程度将多重填补分类为单值填补、单调填补、基于链式方程的多重填补和马尔科夫链蒙特卡罗法。

