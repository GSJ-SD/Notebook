
**参考文献：**  
<font color=blue>[1]熊中敏,郭怀宇,吴月欣.缺失数据处理方法研究综述[J].计算机工程与应用, 2021, 57(14):12.DOI:10.3778/j.issn.1002-8331.2101-0187.</font>    
<font color=blue>[2]帅平,李晓松,周晓华,等.缺失数据统计处理方法的研究进展[J].中国卫生统计, 2013(1):6.DOI:CNKI:SUN:ZGWT.0.2013-01-050.</font>  
<font color=blue>[3]张桥,李宁,张秋菊,等.任意缺失模式缺失数据不同填补方法效果比较[J].中国卫生统计, 2013, 30(5):3.DOI:CNKI:SUN:ZGWT.0.2013-05-019.</font>
<font color=blue>[4]曹阳,谢万军,张罗漫.多重填补的方法及其统计推断原理[J].中国医院统计,2003,(02):77-81.</font>  
<font color=blue>[5]唐健元,杨志敏,杨进波等.临床研究中缺失值的类型和处理方法研究[J].中国卫生统计,2011,28(03):338-341+343.</font>    
\[6\][On Biostatistics and Clinical Trials: Single Imputation Methods for Missing Data: LOCF, BOCF, LRCF (Last Rank Carried Forward), and NOCB (Next Observation Carried Backward)](https://onbiostatistics.blogspot.com/2021/01/single-imputation-methods-for-missing.html)  

******

## 1 缺失数据的类型  
### 1.1 缺失模式分类  

因数据缺失而在数据集中产生的缺失结构叫缺失模式。缺失模式可以用来反映数据集中缺失数据之间的关系。

- **单调缺失模式（monotone missingness pattern）**：假设数据集是由 $n$ 个变量， $p$ 个观测组成的 $p \times n$ 矩阵，对这个矩阵进行适当的行、列对换后，可以得到一个呈现出层级缺失模式的矩阵，这种数据缺失模式被称为单调缺失模式；对于单调缺失模式来说，可以用一些简单的填补方法，不过在大多数复杂的调查中，这种缺失模式很少见。    
- **任意缺失模式（arbitrary missingness pattern）**：不满足单调缺失模式的，被称为任意缺失模式。  

### 1.2 缺失机制分类  

缺失数据和完整数据之间的关系称为缺失机制。缺失机制的意义在能通过完整数据帮助处理缺失数据。Little 和 Rubin 提出了缺失数据的分类方法，根据其理论，缺失机制可分为以下三类情况：

#### 1.2.1 完全随机缺失（missing completely at random, MCAR）  

完全随机缺失指的是观察对象的数据缺失完全是由随机因素造成的，独立于已完成的和将来要进行评价的结果，既不取决于已观察到的数据也不取决于未被观察到的数据。例如因为受试者搬迁而脱落、研究者未能评估或一些设计因素而出现缺失。   

只有当缺失现象属于 MCAR 时，随机选取具有完整数据的个体所组成的样本便可认为是从研究总体中得到的随机样本。因此，<font color=green>对 MCAR 的数据进行删除是不会产生偏倚的</font>。  

尽管 MCAR 要求缺失现象与研究变量无关，但是，研究变量同未被观察数据间的间接关联仍是有可能的。由于这种假设难以被证实，因此进行 MCAR 的假设有时会存在一定问题。  

#### 1.2.2 随机缺失（missing at random, MAR）

MAR 是最常见的缺失机制。观察对象缺失的概率取决于已有的观察结果，不取决于未观察到的结果。==例如在对一个降压药的临床研究中，根据方案，当受试者发现血压控制并不理想( 舒张压太高) 时决定退出研究，那么此时出现的缺失值就属于 MAR==。（这个例子认真的吗？）  

<font color=green>在 MAR 情况下，仅使用具有完整数据的个体进行分析会导致选择性偏倚</font>，因为这些个体所组成的样本不是从研究总体中得到的随机样本。MAR 一般可以从已观察到的某些结果中分析出丢失原因并估算出缺失数据。这类缺失值往往要求采用多重填补（multiple imputation，MI） 的方法进行敏感性分析（sensitivity analysis），以评估缺失值对结论的影响。  

#### 1.2.3 非随机缺失（missing not at random, MNAR）

观察对象的缺失概率与当前尚未观察到的结果有关。在极大似然法（maximum likelihood estimation，MLE）和贝叶斯（Bayesian）理论框架内，MNAR 又被称为“不可忽略性”（non-ignorable）。因为这种缺失大都不是偶然因素造成的，比如疾病进展太快或化疗副作用太强，病人没有能力继续接受随访。MNAR 现象主要取决于缺失值本身，这类情况往往需要通过建立复杂模型来合并缺失机制。==例如乳房假体植入术，当患者满意疗效时便不再回访; 另外，在肿瘤临床研究中，如果患者出现治疗失败也会脱落。==（这个例子和MAR中的例子有哪里不一样吗？）    



一些用于帮助理解的其他例子：
[数据缺失类型：MCAR、MAR、MNAR-CSDN博客](https://blog.csdn.net/whq___/article/details/122649874)
[数据分析中的数据缺失问题 - Lucky_Glass - 博客园 (cnblogs.com)](https://www.cnblogs.com/LuckyGlass-blog/p/17705881.html)



******

## 2 缺失数据的处理  

在临床试验的设计和执行过程中，首先应尽量避免缺失值的出现。当出现缺失值时，一般有三种分析方法可加以处理：

- 忽视含有缺失值的观察资料；  
- 忽视那些出现频繁缺失的变量；  
- 用一些恰当值去替代缺失数据。  

### 2.1 忽视缺失值（ignore / disregard missing data）  

<font color=green>当缺失值属于 MCAR 时才可以忽视这些缺失值，否则会得到一个偏性结论</font>。因为完成临床研究的受试者并不能代表某些亚组人群，同时对不完整信息的丢弃会导致检验效能的降低。  

<font color=green>忽视缺失值仅采用完整病例进行分析，违背了 ITT 原则并可产生偏倚性结论，不推荐将其作为确证性试验的主要结果的缺失数据处理方法</font>。可考虑在以下情况下使用：

- 在探索性研究中，尤其是在药物研发的初期阶段；
- 在确证性试验中，作为次要结果的处理方法，用以支持性分析来说明结论的稳健性。  

### 2.2 数据填补（data imputation）  

为减少试验数据的缺失对试验评价的不良影响，除采取一些积极的预防性措施如研究中强调对主要变量的信息收集、增加样本量以保证检验效能外，还应对缺失值进行填补，从某种程度上去弥补非完整数据的不足。

通常在以下情况中应该将数据填补作为处理缺失数据的策略：

- 相对小的缺失率 ( 例 如 10% ～15% ) ：
- 在临床上或在生物学上，含有缺失值的变量对于所要研究的问题都具有非常重要的意义；
- 有合理的假设和结转技术策略，一般宜遵循保守的原则；
- 不同填补方式产生的结论需进行敏感性分析。  

#### 2.2.1 简单/单一填补（simple / single imputation）  

简单填补法是指就缺失值仅按某个填补方法结转一次，但不足之处在于该方法通常会低估数据的变异性。使用最广泛的简单填补法有末次访视结转和基线访视结转，其他一些方法使用包括脱落前对同一研究对象收集的数据、源自其他具有类似基线特征的研究对象的数据、一个经验研发模型的预计值或历史数据等用于结转缺失值，如最差病例分析或最好病例分析，以及非条件均数/中位数、条件均数、随机回归和热层法等经验研发模型。  

常用简单数据填补方法如下表所示：  
![figure1](./assets/figure1.png#pic_center)  

#### 2.2.1 多重填补（multiple imputation, MI）  

MI 是指通过随机生成值去替代缺失值得到多个原始数据集拷贝，然后再对这些衍生数据集进行分析。缺失数据多重填补过程涉及到贝叶斯理论、马尔可夫链蒙特卡罗( MCMC) 方法和数据增广法( data augmentation，DA) ，其中 DA 是期望值最大化法则( expectation maximization，EM) 算法的扩展算法。  

<font color=green>MI 假设的基础在于数据缺失机制为非 MNAR( 主要为 MAR) ，且数据满足多元正态分布</font>。  

数据填补是 MI 统计分析中的关键一步，填补时一方面要考虑到填补的不确定性，同时还要考虑到所观察的完整变量与缺失变量之间的相关性。对于每一个缺失数据填补 $k$ 次，这 $k$ 个数据按照某种要求进行排列，这样第一次用于填补缺失值的数据集就会产生第一个完整数据集，以此类推，最终 $k$ 次填补将会产生 $k$ 个完整数据集。每一个经填补后得到的完整数据集都将采用标准的完整数据分析过程进行分析。通常，这些分析过程会忽略原数据集中观测到与未观测到的数据间的差别。在对每一个填补数据集分析得到的结果基础上再进行综合，即产生最终的统计推论。  

常用缺失数据多重填补方法如下：
![figure2](./assets/2024-01-09-002.png#pic_center)  