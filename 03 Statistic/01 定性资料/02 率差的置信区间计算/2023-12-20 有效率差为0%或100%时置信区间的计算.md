

**参考文献：**  
<font color=blue>[1]唐欣然,黄耀华,王杨等.Newcombe-Wilson得分方法在有效率为100%非劣效临床试验中的应用[J].中华疾病控制杂志,2015,19(02):190-192.DOI:10.16462/j.cnki.zhjbkz.2015.02.022</font>  
<font color=blue>[2]黄耀华,唐欣然,段重阳等.两组率同为100%或0%时率差置信区间估计的SAS实现[J].中国卫生统计,2017,34(01):11-14. </font> 
*********

### 1 前言  

在医疗器械临床试验中，某些产品( 如骨科的骨钉、骨板) 常常由于技术相对成熟，成功率和有效率往往能达到100% 。这类产品的研究设计如果为非劣效随机对照试验，研究者往往会保守地估计产品的成功率，如 98% ，99% ，并且结合临床上认可的非劣效界值，计算所需要的样本量。但如果临床试 验最终的结果未出现无效的病例，即本次试验中试 验组和对照组成功率都为100% ，传统的CMH( cochran-mantal haenszel) 卡方因无法估计两组率差的标准误而无法计算率差的置信区间，进而无法判断率差 置信区间与预先设定的非劣效界值的关系<sup>[1]</sup>。  

医学研究领域，有时会遇到一种极端的结果，即两个比较组的事件发生率均为 100% 或 0% ，如 CT 成像的优良率、关节置换的成功率、使用脑膜贴片的脑脊液渗漏率等，此时两组的率差为 0。<font color=blue>目前，常用的两组事件发生率均为 100% 或 0% 时率差的置信区间估计方法有 三 种，分 别 是 Miettinen Nurminen 法、Newcombe-Wilson 法和校正 Newcombe-Wilson 法</font><sup>[2]</sup>。
********

### 2 Newcombe-Wilson 法  
#### 2.1 方法简介 

在试验的设计阶段，非劣效临床试验往往采用正态近似方法估算样本量，SAS 程序中的 CMH 卡方能直接输出两组率差的点估计和置信区间，然而在两组率都为 100% 情况下，正态近似方法将无法估算两组有效率的合并方差，从而无法获得两组率差的置信区间。  

Newcombe-Wilson 得分方法由 Newcombe 在 1998 年率先提出，在比较 11 种率差的计算方法之后，Newcombe 从保守性和可行性方面推荐使用 Wilson 得分方法计算率差的 置信区间。目前该方法已被 FDA 指南推荐使用，作为事件率可能为 0% 或 100% 率差置信区间计算方法的首选。

连续校正 Newcombe-Wilson 得分方法在所有计算率差方法中为最保守的一种方法，率差计算公式同 Newcombe-Wilson 得分方法，区别在于单组置信区间的计算公式有所调整。连续校正方法因单组率计算的调整而增加可信区间的宽度，从而更加保守地估计组间差异。 

Newcombe-Wilson 得分方法和连续校正的 Newcombe-Wilson 得分方法计算过程相对简单，通过简单的 SAS 或 Excel 编程即可实现，非常易于使用。 

#### 1.2 计算公式  
##### 1.2.1 Newcombe-Wilson 法  

通过 Wilson 法分别得到得到两单样本率的置信区间上下限，Wilson 法单样本率置信区间上下限为等式 $(z_{\alpha/2}^2+n)\pi^2-(z_{1-\alpha/2}^2+2np)\pi+np^2=0$ 中 $\pi$ 的两个解，其中 $n$ 表示单组的样本量， $p$ 表示单组的事件发生率（$q=1-p$）。求解可得单组率置信区间 $(l,u)$ 的计算公式为：  
$$\frac{2np+z^2\pm z\sqrt{z^2+4npq}}{2(n+z^2)} \tag{1}$$   
Newcombe-Wilson 法通过杂交方式构建出率差置信区间上下限 $(L,U)$ 如下：  
$$\begin{align}
L = & p_1-p_2-\sqrt{(p_1-l_1)^2+(u_2-p_2)^2}  \tag{2} \\
U = & p_1-p_2+\sqrt{(p_2-l_2)^2+(u_1-p_1)^2}  \tag{3}
\end{align}$$

其中 $l_1$ ， $u_1$ ， $l_2$ ， $u_2$ 分别为两组率 Wilson 得分方法计算得到的置信区间上下限。   

##### 1.2.2 校正 Newcombe-Wilson 法  

连续校正 Newcombe-Wilson 得分方法相对较为保守，其率差计算公式杂交方法同 Newcombe-Wilson 得分方法，区别在于 Wilson 单组置信区间的计算公式有所调整，采用了连续性校正后的结果，具体计算公式为：  

$$\begin{align}
l = & \frac{2np+z^2-1-z\sqrt{z^2-2-1/n+4p(qn+1)}}{2(n+z^2)} \tag{4} \\
u = & \frac{2np+z^2+1+z\sqrt{z^2+2-1/n+4p(qn-1)}}{2(n+z^2)} \tag{5}
\end{align}$$

#### 1.3 SAS实现  

示例程序如下：  
```SAS
/*两组率均为0%或100%*/
/*事件数据集*/
data event1;
    arm="试验组"; event="有效"; count=59; output;
    arm="试验组"; event="无效"; count=0; output;
    arm="对照组"; event="有效"; count=56; output;
    arm="对照组"; event="无效"; count=0; output;
run;

/*数据集格式整理*/
data _count;
    g1_v1 = 59; g1_v2=0; g1=59+0; g2_v1=56; g2_v2=0; g2=56+0; output;
run;

/*Wilson法求单组率置信区间上下限*/
data _wilsonCI;
    set _count;
    z=probit(1-0.025);
    l1 = (2*g1*(g1_v1/g1)+z**2-z*sqrt(z**2+4*g1*(g1_v1/g1)*(g1_v2/g1)))/(2*(g1+z**2));
    u1 = (2*g1*(g1_v1/g1)+z**2+z*sqrt(z**2+4*g1*(g1_v1/g1)*(g1_v2/g1)))/(2*(g1+z**2));

    l2 = (2*g2*(g2_v1/g2)+z**2-z*sqrt(z**2+4*g2*(g2_v1/g2)*(g2_v2/g2)))/(2*(g2+z**2));
    u2 = (2*g2*(g2_v1/g2)+z**2+z*sqrt(z**2+4*g2*(g2_v1/g2)*(g2_v2/g2)))/(2*(g2+z**2));
run;

/*Newcombe-Wilson法求率差置信区间上下限*/
data _newcombeCI;
    set _wilsonCI;
    L = (g1_v1/g1)-(g2_v1/g2)-sqrt(((g1_v1/g1)-l1)**2+(u2-(g2_v1/g2)));
    U = (g1_v1/g1)-(g2_v1/g2)+sqrt(((g2_v1/g2)-l2)**2+(u1-(g1_v1/g1)));
run;
```

#### 1.4 实例分析  

某项用于骨折患者的骨板临床试验为一非劣效试验，欲证明试验产品非劣于对照产品。  

在前期的预试验中，产品的有效率为 100% 。在本次试验设计中，为保守估计产品的疗效，假设试验组和对照组应用于骨折患者术后 6 个月的有效率为 98% ，临床上认可的非劣效界值为 10% ，通过正态近似的样本 量计算公式获得每组至少 31 例受试者，并考虑 6 个月随访时 5% 脱落率，则每组入选 33 例，两组共入选 66 例受试者进入试验。   

试验的最终结果为试验组和对照组在 6 个月内没有发生失访，所有病人按照规定随访时间完成随访，最终纳入 FAS( full analysis set) 、PPS( per-protocol set) 受试者人数都为试验组 33 例，对照组33 例。   

FAS、PPS 数据集中，试验组有效率为 100% ，对照组有效率为 100% ，根据 Newcombe-Wilson 得分方法计算两组有效率差值的点估计和置信区间估计，为 0. 0% ( － 10. 4%，10. 4% ) 。通过与预先设定的非劣效界值 － 10%相比，置信区间的下限已经超出非劣效界值，试验失败。  

其原因是试验设计阶段采用的是近似正态的样本量估计方法，而评价阶段由于近似正态方法无法计算率差的置信区间而采用的是 Newcombe-Wilson 得分方法，设计和评价的方法不一致， 导致即使所有的病例都成功，试验却失败的结果。   

<font color=blue>因此在试验设计阶段，当产品的有效率可能为 100% 时，研究者不仅要保守估计产品的有效率，还要考虑产品有效率一旦达到 100% 的试验设计。</font>因 此上述例子中，除了常规计算样本量 31 例之外，还需设计有效率为 100% 的情况，通过 Newcombe-Wilson 得分方法进行研究设计。即假设产品最终有效率为 100% ，非劣效界值取 10% ，通过 Newcombe-Wilson 得分方法反推的样本量计算公式求得每组至少 35 例，考虑 5% 脱落，每组 37 例，两组共需 74 例受试者。取两次样本量最大的结果作为最终的样本量，即最终需要 74 例受试者才能证明非劣效的研究假设。表 1 列出了有效率为 100% 不同非劣效界值下 Newcombe-Wilson 得分方法设计对应的每组样本量。  